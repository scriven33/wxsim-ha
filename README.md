# Home Assistant integration for WXSIM
This is a basic method to get a forecast generated by WXSIM (https://www.wxsim.com/) in to Home Assistant. 

## Requirements

This integration will require a web server, correctly configured to server JSON files. 

## Generating the JSON file

To generate the JSON file, put the POwerShell script on to the same server as either WXSIM, or where you are puting the latest.csv file.
Then adjust the paths at the top to show the location of the latest.csv file and where you want to place the JSON file. 

You then need to run the PowerShell file each time WXSIM creates a new forecast. The easiest way to do this is via the post prcoessing script batch file. 
Add this line to the batch file. 

Powershell -noprofile -executionpolicy bypass -file "C:\wxsim\json.ps1"

After generating the file, you should be able to view it in your browser using the file name listed at the top of the file. 

## Home Assistant

Integrating it in to Home Assistant requires two steps. The REST sensor to bring the data in, and then a forecast generated from the REST information. 

### REST Sensor

Copy the contents of wxsim.yaml in to your includes directory for Sensor information. See https://www.home-assistant.io/docs/configuration/splitting_configuration/ for using Includes. 
This allows you to keep the content seperate. 

Adjust the URL for the sensor to match the one that you have setup. After adding in the sensor, reboot Home Assistant, and then check the sensors have been created using Developer Tools. 
You only need the top sensor - the rest simply crate additional sensors which can then be used in automations. Remove any that you don't need. 

### Weather Forecast

With the sensors created, you can now create the weather forecast. 

Copy the contents of wxsim_forecast.yaml into your configuration.yaml or if you are using includes, in to its own file under the weather directory/file. 
Reboot Home Assistant. You should then find tha you have the forecast listed as weather.wxsim, which you can integrate in to Weather Cards as required. 

